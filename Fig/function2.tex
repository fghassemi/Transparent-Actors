\begin{tikzpicture}[scale=0.8, transform shape]
%synchronous is full triangle
% -------------Actor left ---------------
\draw[line width=1pt]  (0,0) rectangle (2,1);
\node at (1,.5) {\small :$\it Actor$};
\draw (1,0) -- (1,-5);

\draw[line width=1pt]  (2.5,0) rectangle (4.5,1);
\node at (3.5,0.5) {\small :$\it Buffer$};
\draw (3.5,0) -- (3.5,-5);

%---------------Network --------------------
\draw[line width=1pt]  (5.5,0) rectangle (8.5,1);
\node at (7,0.5) {\small :$\it Abstract~ Network$};
\draw (7,0) -- (7,-5);
\draw[line width=1pt]  (9,0) rectangle (11,1);
\node at (10,0.5) {\small :$\it Buffer$};
\draw (10,0) -- (10,-5);
%---------------Actor right-------------------------------
\draw[line width=1pt]  (14.5,0) rectangle (16.5,1);
\node at (15.5,.5) {\small :$\it Actor$};
\draw (15.5,0) -- (15.5,-5);

\draw[line width=1pt]  (12,0) rectangle (14,1);
\node at (13,0.5) {\small :$\it Buffer$};
\draw (13,0) -- (13,-5);

%---------------sending--------------------
%Actor left layer
\node (s1) at (0,-0.7)  {};
\node (s2) at (1,-0.7) {};
\draw[->] (s1) edge[sloped,above] node{$\it send$} (s2);

\node (v1) at (1,-0.7)  {};
\node (v2) at (7,-1) {};
\draw[fill=white]  (0.9,-0.6) rectangle (1.1,-1);

%----------------------------------
%Network layer



\draw[->] (v1) edge[sloped,above] node{$\it receive$} (v2);
\draw[fill=white]  (6.9,-0.9) rectangle (7.1,-2.1);

\draw[fill=white]  (6.9,-2.3) rectangle (7.1,-3.9);
\node (r1) at (5.4,-2.5)  {};
\node (r2) at (6.9,-2.5) {};
\draw[->] (r1) edge[sloped,above] node{\small $\it transfer$} (r2);


%--------------Network buffer --------------------------------
\node (t1) at (7.1,-1.2)  {};
\node (t2) at (9.9,-1.4) {};
\draw[fill=white]  (9.9,-1.2) rectangle (10.1,-2.1);
\draw[-triangle 60] (t1) edge[sloped,above] node{$\it put$} (t2);

%\draw[-triangle 60] (7,-1.7) edge[loop right] node{$\it transfer$} (7,-1.7);
\draw[-triangle 60]  (10.1,-1.5) -- (10.4,-1.5) -- (10.4,-2) -- (10.1,-2);
\node (v3) at (11,-1.8)  {$\it insert$};
% node {$\it transfer$}(7.1,-1.8);
%\draw[fill=white]  (3.9,-2.1) rectangle (4.1,-2.5);

\node (t1) at (7.1,-2.5)  {};
\node (t2) at (9.9,-2.7) {};
\draw[fill=white]  (9.9,-2.5) rectangle (10.1,-3.4);
\draw[-triangle 60] (t1) edge[sloped,above] node{$\it select$} (t2);

%\draw[-triangle 60] (7,-1.7) edge[loop right] node{$\it transfer$} (7,-1.7);
\draw[-triangle 60]  (10.1,-2.7) -- (10.4,-2.7) -- (10.4,-3.2) -- (10.1,-3.2);
\node (v3) at (11,-2.95)  {$\it remove$};
% node {$\it transfer$}(7.1,-1.8);
%\draw[fill=white]  (3.9,-2.1) rectangle (4.1,-2.5);

\node (m1) at (9.9,-3.2)  {};
\node (m2) at (7.1,-3.4) {};
\draw[fill=white]  (9.9,-2.5) rectangle (10.1,-3.4);
\draw[dashed,->] (m1) edge[sloped,above] node{$\it msg$} (m2);
%-----------------------------------------------------------------

%Actor right
\draw[fill=white]  (15.4,-3.6) rectangle (15.6,-4.2);
\node (a1) at (7.1,-3.5)  {};
\node (a2) at (15.4,-3.8) {};
\draw[->] (a1) edge[sloped,above] node{$\it receive$} (a2);

\node (a1) at (15.4,-3.9)  {};
\node (a2) at (13.1,-4.1) {};
\draw[-triangle 60] (a1) edge[sloped,below] node{$\it put$} (a2);
\draw[-triangle 60]  (12.9,-4.2) -- (12.6,-4.2) -- (12.6,-4.7) -- (12.9,-4.7);
\node (v3) at (12,-4.45)  {$\it insert$};

%Actor buffer right
\draw[fill=white]  (12.9,-4) rectangle (13.1,-4.9);
%\draw[-triangle 60] (v3) edge[sloped,below] node{$\it receive$} (v4);

%\draw[->,dashed] (7,-2.4) edge[sloped, below] node{\small {msgs ready to be delivered}} (4,-2.7);

%-----------------buffer actor right
\draw[fill=white]  (3.4,-3.2) rectangle (3.6,-4.1);

\node (v5) at (1.1,-3)  {};
\node (v6) at (3.4,-3.3) {};
\draw[-triangle 60] (v5) edge[sloped,above] node{$\it select$} (v6);

\node (v7) at (3.4,-3.9)  {};
\node (v8) at (1.1,-4.2) {};
\draw[->,dashed] (v7) edge[sloped,above] node{\small $msg$} (v8);
\draw[-triangle 60]  (3.6,-3.3) -- (3.9,-3.3) -- (3.9,-3.8) -- (3.6,-3.8);
\node (v3) at (4.6,-3.6)  {$\it remove$};
%-------------------------------
%actor right
\draw[fill=white]  (0.9,-2.9) rectangle (1.1,-4.4);
\node (tt1) at (0,-3)  {};
\node (tt2) at (1,-3) {};
\draw[->] (tt1) edge[sloped,above] node{$\it take$} (tt2);

%\draw[<->,dashed] (1,-0.7) -- (1,-0.7) ;

\end{tikzpicture}